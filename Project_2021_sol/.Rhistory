theme_minimal()
med <- ggplot(Ind_Stat, aes(x=variable, y=median, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=median), vjust=-0.3, size=3.5)+
theme_minimal()
sd <- ggplot(Ind_Stat, aes(x=variable, y=sd, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=sd), vjust=-0.3, size=3.5)+
theme_minimal()
mad <- ggplot(Ind_Stat, aes(x=variable, y=mad, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=mad), vjust=-0.3, size=3.5)+
theme_minimal()
cv <- ggplot(Ind_Stat, aes(x=variable, y=coef_de_var, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=coef_de_var), vjust=-0.3, size=3.5)+
theme_minimal()
max <- ggplot(Ind_Stat, aes(x=variable, y=max, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=max), vjust=-0.3, size=3.5)+
theme_minimal()
min <- ggplot(Ind_Stat, aes(x=variable, y=min, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=min), vjust=-0.3, size=3.5)+
theme_minimal()
library(cowplot)
plot_grid(moy, med, sd, mad, cv, max, min, labels = c("Moyenne", "Mediane",
"écart type", "median absolute deviation", "coefficient de variation", "maximum", "minimum"))
library(ggplot2)
moy <- ggplot(Ind_Stat, aes(x=variable, y=mean, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=mean), vjust=-0.3, size=3.5)+
theme_minimal()
med <- ggplot(Ind_Stat, aes(x=variable, y=median, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=median), vjust=-0.3, size=3.5)+
theme_minimal()
sd <- ggplot(Ind_Stat, aes(x=variable, y=sd, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=sd), vjust=-0.3, size=3.5)+
theme_minimal()
mad <- ggplot(Ind_Stat, aes(x=variable, y=mad, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=mad), vjust=-0.3, size=3.5)+
theme_minimal()
cv <- ggplot(Ind_Stat, aes(x=variable, y=coef_de_var, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=coef_de_var), vjust=-0.3, size=3.5)+
theme_minimal()
max <- ggplot(Ind_Stat, aes(x=variable, y=max, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=max), vjust=-0.3, size=3.5)+
theme_minimal()
min <- ggplot(Ind_Stat, aes(x=variable, y=min, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=min), vjust=-0.3, size=3.5)+
theme_minimal()
library(cowplot)
plot_grid(moy, med, sd, mad, cv, max, min, labels = c("Moy", "Med",
"Sd", "Mad", "cv", "max", "min"))
plot_grid(moy, med, sd, mad, cv, max, min, labels = c("Moy", "Med",
"Sd", "Mad", "cv", "max", "min"), label_size = 14, hjust = -0.5, vjust =1.5, greedy = TRUE)
plot_grid(moy, med, sd, mad, cv, max, min, labels = c("Moy", "Med",
"Sd", "Mad", "cv", "max", "min"), label_size = 14, hjust = -0.5, vjust =1.5, greedy = TRUE, byrow = T)
plot_grid(moy, med, sd, mad, cv, max, min, labels = c("Moy", "Med",
"Sd", "Mad", "cv", "max", "min"), label_size = 14, label_x = 0, label_y = 1, hjust = -0.5, vjust =1.5, greedy = TRUE, byrow = T)
plot_grid(moy, med, sd, mad, cv, max, min, labels = c("Moy", "Med",
"Sd", "Mad", "cv", "max", "min"), label_size = 14, label_x = 5, label_y = 1, hjust = -0.5, vjust =1.5, greedy = TRUE, byrow = T)
plot_grid(moy, med, sd, mad, cv, max, min, labels = c("Moy", "Med",
"Sd", "Mad", "cv", "max", "min"), label_size = 14, label_x = 25, label_y = 10, hjust = -0.5, vjust =1.5, greedy = TRUE, byrow = T)
plot_grid(moy, med, sd, mad, cv, max, min, labels = c("Moy", "Med",
"Sd", "Mad", "cv", "max", "min"), label_size = 14, label_x = 50, label_y = 10, hjust = -0.5, vjust =1.5, greedy = TRUE, byrow = T)
plot_grid(moy, med, sd, mad, cv, max, min, labels = c("Moy", "Med",
"Sd", "Mad", "cv", "max", "min"), label_size = 14, label_x = 100, label_y = 25, hjust = -0.5, vjust =1.5, greedy = TRUE, byrow = T)
plot_grid(moy, med, sd, mad, cv, max, min, labels = c("Moy", "Med",
"Sd", "Mad", "cv", "max", "min"), label_size = 14, hjust = -0.5, vjust =1.5, greedy = TRUE, byrow = T)
complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = n / sum(n)) %>%
filter(french == T) %>%
ggplot(aes(x=decade, y=effectif, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal()
complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = n / sum(n)) %>%
filter(french == T) %>%
ggplot(aes(x=decade, y=nombre, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal()
complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = n / sum(n)) %>%
filter(french == T) %>%
ggplot(aes(x=decade, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal()
complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = n / sum(n)) %>%
filter(french == T) %>%
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = n / sum(n)) %>%
filter(french == T) %>%
ggplot(dt, aes(x=decade, y=nombre, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal()
ggplot(dt, aes(x=decade, y=nombre, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal()
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = n / sum(n)) %>%
filter(french == T) %>%
ggplot(dt, aes(x=decade, y=nombre, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal()
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = n / sum(n)) %>%
filter(french == T) %>%
dt
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = n / sum(n)) %>%
filter(french == T)
ggplot(dt, aes(x=decade, y=nombre, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal()
ggplot(dt, aes(x=decade, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal()
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = n / sum(n)) %>%
filter(french == T)
dt
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = n / sum(n)) %>%
filter(french == T)
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal()
dt
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = (n / sum(n))*100) %>%
filter(french == T)
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal()
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(round(p = (n / sum(n))*100),2) %>%
filter(french == T)
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(round(p = (n / sum(n))*100 ,2)) %>%
filter(french == T)
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(round(p = (n / sum(n))*100),2) %>%
filter(french == T)
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
round(mutate(p = (n / sum(n))*100),2) %>%
filter(french == T)
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = (n / sum(n))*100) %>%
filter(french == T)
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal()
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
scale_y_continuous(labels = scales::percent) +
theme_minimal()
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = scales::percent(n / sum(n))*100) %>%
filter(french == T)
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = scales::percent(n / sum(n))) %>%
filter(french == T)
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal()
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = scales::percent(n / sum(n))) %>%
filter(french == T)
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal() +
labs(title = "Représentation de la quantité de films /n dans lesquels la langue française apparait par décenie",
x = "Effectif", y = "Décennie")
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal() +
labs(title = "Représentation de la quantité de films /n dans lesquels la langue française apparait par décenie",
x = "Décennie", y = "Effectif")
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = scales::percent(n / sum(n))) %>%
filter(french == T)
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal() +
labs(title = "Représentation de la quantité de films dans lesquels la langue française apparait par décenie",
x = "Décennie", y = "Effectif")
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p, label=n), vjust=-0.3, size=3.5)+
theme_minimal() +
labs(title = "Représentation de la quantité de films dans lesquels la langue française apparait par décenie",
x = "Décennie", y = "Effectif")
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=n,p), vjust=-0.3, size=3.5)+
theme_minimal() +
labs(title = "Représentation de la quantité de films dans lesquels la langue française apparait par décenie",
x = "Décennie", y = "Effectif")
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p, n), vjust=-0.3, size=3.5)+
theme_minimal() +
labs(title = "Représentation de la quantité de films dans lesquels la langue française apparait par décenie",
x = "Décennie", y = "Effectif")
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal() +
labs(title = "Représentation de la quantité de films dans lesquels la langue française apparait par décenie",
x = "Décennie", y = "Effectif")
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=c(n,p)), vjust=-0.3, size=3.5)+
theme_minimal() +
labs(title = "Représentation de la quantité de films dans lesquels la langue française apparait par décenie",
x = "Décennie", y = "Effectif")
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal() +
labs(title = "Représentation de la quantité de films dans lesquels la langue française apparait par décenie",
x = "Décennie", y = "Effectif")
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal() +
labs(title = "Représentation de la quantité de films dans lesquels la langue française apparait par décenie",
x = "Décennie", y = "Effectif")
complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = n / sum(n)) %>%
filter(french == T) %>%
ggplot(aes(y = decade, label = p)) +
geom_bar(aes(weight = p), fill = "steelblue")+
scale_x_continuous(labels = scales::percent) +
theme(plot.title = element_text(hjust = .5)) +
labs(title = "Représentation de la proportion de films /n dans lesquels la langue française apparait par décenie",x = "Pourcentage", y = "Décennie")
dt <- complete_data %>%
select(language, decade) %>%
group_by(decade) %>%
count(french = str_detect(language, "French|.French.")) %>%
mutate(p = scales::percent(n / sum(n))) %>%
filter(french == T)
ggplot(dt, aes(x=decade,y=n, fill=decade)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=p), vjust=-0.3, size=3.5)+
theme_minimal() +
labs(title = "Représentation de la quantité de films dans lesquels la langue française apparait par décenie",
x = "Décennie", y = "Effectif")
data <-complete_data %>%
select(starts_with("avg_vote_"))
report <- function(x, name) {
tibble(
variable  = name,
mean = round(mean(x, na.rm = FALSE), 2),
median = round(median(x, na.rm = FALSE), 2),
sd = round(sd(x), 2),
mad = round(mad(x, center = median(x), constant = 1.4826, na.rm = FALSE,
low = FALSE, high = FALSE), 2),
coef_de_var = round((sd(x)/mean(x))*100, 2),
max = round(max(x), 2),
min = round(min(x), 2)
)
}
Ind_Stat <- data %>% imap_dfr(report)
data <-complete_data %>%
select(starts_with("avg_vote_"))
report <- function(x, name) {
tibble(
variable  = name,
mean = round(mean(x, na.rm = FALSE), 2),
median = round(median(x, na.rm = FALSE), 2),
sd = round(sd(x), 2),
mad = round(mad(x, center = median(x), constant = 1.4826, na.rm = FALSE,
low = FALSE, high = FALSE), 2),
coef_de_var = round((sd(x)/mean(x))*100, 2),
max = round(max(x), 2),
min = round(min(x), 2)
)
}
Ind_Stat <- data %>% imap_dfr(report)
Ind_Stat
library(ggplot2)
moy <- ggplot(Ind_Stat, aes(x=variable, y=mean, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=mean), vjust=-0.3, size=3.5)+
theme_minimal()
med <- ggplot(Ind_Stat, aes(x=variable, y=median, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=median), vjust=-0.3, size=3.5)+
theme_minimal()
sd <- ggplot(Ind_Stat, aes(x=variable, y=sd, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=sd), vjust=-0.3, size=3.5)+
theme_minimal()
mad <- ggplot(Ind_Stat, aes(x=variable, y=mad, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=mad), vjust=-0.3, size=3.5)+
theme_minimal()
cv <- ggplot(Ind_Stat, aes(x=variable, y=coef_de_var, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=coef_de_var), vjust=-0.3, size=3.5)+
theme_minimal()
max <- ggplot(Ind_Stat, aes(x=variable, y=max, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=max), vjust=-0.3, size=3.5)+
theme_minimal()
min <- ggplot(Ind_Stat, aes(x=variable, y=min, fill=variable)) +
geom_bar(stat="identity", color="black")+
geom_text(aes(label=min), vjust=-0.3, size=3.5)+
theme_minimal()
library(cowplot)
plot_grid(moy, med, sd, mad, cv, max, min, labels = c("Moy", "Med",
"Sd", "Mad", "cv", "max", "min"), label_size = 14, hjust = -0.5, vjust =1.5, greedy = TRUE, byrow = T)
names(complete_data)
complete_data$votes
complete_data$avg_vote
boxplot(complete_data$genre ~ complete_data$votes,
col = "purple", border = "black",
main = "Votes en fonction de genre",
ylab = "genre du cinema"
)
boxplot(complete_data$genre ~ complete_data$votes,
col = "purple", border = "black",
main = "Votes en fonction de genre",
ylab = "genre du cinema"
)
complete_data$votes
type(complete_data$votes)
typeof(complete_data$votes)
typeof(complete_data$genre)
boxplot(complete_data$votes ~ complete_data$genre,
col = "purple", border = "black",
main = "Votes en fonction de genre",
ylab = "genre du cinema"
)
boxplot(complete_data$votes ~ complete_data$genre,
col = "green", border = "yellow",
main = "Votes en fonction de genre",
ylab = "genre du cinema"
)
boxplot(complete_data$votes ~ complete_data$genre,
col = "red", border = "green",
main = "Votes en fonction de genre",
ylab = "genre du cinema"
)
tapply(complete_data$votes, complete_data$genre, mean, na.rm=TRUE)
hist(complete_data$votes) # oui, cette variable suit une loi normale
qqnorm(complete_data$votes) ; qqline(complete_data$votes)
boxplot(complete_data$votes ~ complete_data$genre,
col = "red", border = "green",
main = "Votes en fonction de genre",
ylab = "genre du cinema"
)
boxplot(complete_data[,c("votes","genre")],
col = c("yellow"),                 #Pour la couleur
main = paste("Boxplot"),     #Pour le titre
ylab = "Quantiles")              #Pour le titre de l’axe des ordonnées
boxplot(complete_data[,c("votes")],
col = c("yellow"),                 #Pour la couleur
main = paste("Boxplot"),     #Pour le titre
ylab = "Quantiles")              #Pour le titre de l’axe des ordonnées
boxplot(complete_data$votes ~ complete_data$genre,
col = "red", border = "green",
main = "Votes en fonction de genre",
ylab = "genre du cinema"
)
ggplot(complete_data, aes(x=genre, y=votes))+
geom_boxplot(fill="lightblue")
ggplot(complete_data,aes(x=votes))+
geom_histogram(fill="orange",bins=10)+
facet_grid(genre~.)+
scale_y_sqrt()
unique(complete_data$genre)
uni_genre <- unique(complete_data$genre)
ggplot(complete_data, aes(x=unique(complete_data$genre), y=votes))+
geom_boxplot(fill="lightblue")
ggplot(complete_data, aes(x=genre, y=votes))+
geom_boxplot(fill="lightblue")
complete_data %>%
group_by(genre) %>%
summarise(moy_largeur=mean(largeur),
max_largeur=max(largeur),
min_largeur=min(largeur),
sd_largeur=sd(largeur))
complete_data %>%
group_by(genre) %>%
summarise(moy_votes=mean(votes),
max_votes=max(votes),
min_votes=min(votes),
sd_votes=sd(votes))
ggplot(complete_data, aes(x=genre, y=votes))+
geom_boxplot(fill="lightblue")
boxplot(complete_data$votes ~ complete_data$genre)
ggplot(complete_data, aes(x=genre, y=votes))+
geom_boxplot(fill="lightblue")
boxplot(complete_data$votes ~ complete_data$genre,
col = "purple", border = "black",
main = "Votes en fonction du genre de cinema",
ylab = "Votes"
)
boxplot(complete_data$votes ~ complete_data$genre,
col = "purple", border = "black",
main = "Votes en fonction du genre de cinema",
xlab = "genre"
ylab = "Votes"
boxplot(complete_data$votes ~ complete_data$genre,
col = "purple", border = "black",
main = "Votes en fonction du genre de cinema",
xlab = "genre",
ylab = "Votes"
)
boxplot(complete_data$votes ~ complete_data$genre,
col = "purple", border = "black",
main = "Votes en fonction du genre de cinema",
xlab = "Genre",
ylab = "Votes"
)
ggplot(complete_data, aes(x=group_by(genre), y=votes))+
geom_boxplot(fill="lightblue")
boxplot(complete_data$votes ~ complete_data$genre,
col = "purple", border = "black",
main = "Votes en fonction du genre de cinema",
xlab = "Genre",
ylab = "Votes"
)
